<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <title>dctc by Dataiku - Protocols</title>

  <link rel="stylesheet" href="stylesheets/styles.css">
  <link rel="stylesheet" href="stylesheets/pygment_trac.css">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1><a href="index.html">dctc</a></h1>
        <p>Dataiku Cloud Transport Client</p>

        <p class="view">

             <p>Cloud transfers made simple</p>
            <ul class="view">
                <li><a href="index.html#install">How to <strong>Download</strong></a></li>
                <li><a href="https://github.com/dataiku/dctc">View On <strong>GitHub</strong></a></li>
            </ul>

        </p>

        <p>&nbsp;</p>
        <h4>Documentation</h4>
        <ul>
          <li><a href="index.html">Overview</a></li>
          <li><a href="commands.html">Commands</a></li>
          <li><a href="protocols.html">Protocols</a></li>
        </ul>
    </header>
      <section>
        <h1>Protocols configuration</h1>
        
        <h2>Protocols, accounts, default account</h2>
        
        <p>
          All <code>dctc</code> commands operate on files, across all protocols supported by <code>dctc</code>.<br />
          In <code>dctc</code> command lines, files are denoted by <em>URLs</em>.
          URL schemes are specific to each protocol and are detailed below.
        </p>
        
        <p>
          For example, the following <code>cp</code> command copies an input file in the S3 protocol, 
          to an output file in the hdfs protocol:
        </p>
        <code><pre>% dctc cp s3://bucket/path hdfs:///path/to/output/file</pre></code>

        <p>
          Most protocols supported by dctc have a notion of <em>user account</em>.<br />
          <code>dctc</code> supports multiple accounts per protocol, with one of the accounts
          being the <em>default account</em> for the protocol.<br />
          Non-default accounts are generally accessed using the <code>account@</code>
          prefix in the URL. For example, to copy a S3 file from the account named "a2"
          to a local file, use:
        </p>
        <code><pre>% dctc cp s3://a2@bucket/path local-path</pre></code>
        
        <h2>Configuration file</h2>
        <p>
          dctc has a configuration file, stored:
        </p>
        <ul>
          <li>in <strong>~/.dctcrc</strong> on Unix (Linux, Mac OS X) systems</li>
          <li>in <strong>User directory/dctcrc</strong> on Windows</li>
        </ul>
        <p>
          For each protocol, the configuration file has a section like
        </p>
        <pre><code>[protocol_name]
default = account_name1 # Indicates which of the accounts for this protocol should be the default account
account_name1.param1 = value
account_name1.param2 = value
account_name2.param1 = value
account_name2.param2 = value</code></pre>

        <p>
          Parameter names are specific to each protocol.<br />
          If there is only one account defined for a protocol, the <code>default</code> setting is optional.<br />
          A default configuration file is automatically created the first time you run dctc.<br />
        </p>

        <h1>Hadoop HDFS</h1>

        <h2>Configuration</h2>

        <p> If you have the <code>HADOOP_HOME</code> or <code>HADOOP_PREFIX</code> environment variable defined, you do not need any configuration, <code>dctc</code> will automatically connect to your Hadoop environment.</p>

        <p>Else, you need to create a configuration entry with one configuration parameter : <conf>hadoopConfDir</code>. This must point to the location of your "conf" folder in Hadoop (ie, the folder containing the <code>core-site.xml</code> file).</p>

        <pre><code>[hdfs]
account1.hadoopConfDir=/opt/hadoop/hadoop-0.20.2/conf</code></pre>

        <h2>URLs</h2>

        <p>
          URLs are in the form <code>hdfs://PATH</code>, where PATH is an absolute path within the HDFS filesystem.<br />
          For example: <code>hdfs:///web-data/tracking-logs</code>.<br />
          Non-default accounts are accessed with the syntax <code>hdfs://account@PATH</code>.<br />
          For example: <code>hdfs://my_hdfs_2@/other/path/on/other/hdfs</code>.
        </p>
        
        <p><strong>Important note</strong>: If you use the environment variables instead of using the 
          configuration file, you can only have one HDFS account, the default one.<br />
          If you define any account in your configuration file, the environment variables are ignored.
        </p>

        <h2>MapR FS</h2>

        <p>To access MapR filesystems, dctc needs some additional code and configuration. TODO</p>

        <h1>Amazon S3</h1>

        <h2>Configuration</h2>

        <p>For S3, dctc provides an automatic wizard to help you configure your account. Run it with:</p>
        <pre><code>% dctc add-account s3 [account_name]</code></pre>
        <p>If you want to add multiple S3 accounts, specifying an account name is mandatory.</p>

        An S3 account can also be manually configured. The following parameters are recognized:
        <ul>
          <li><strong>access_key</strong>: AWS access key</li>
          <li><strong>secret_key</strong>: AWS secret key</li>
          <li><strong>default_path</strong>: A fragment that will be prepended to all non-absolute paths</li>
        </ul>

        <p>To create an AWS access key / secret key pair, go to the <a href="https://portal.aws.amazon.com/gp/aws/securityCredentials">Security Credentials</a> page of your <a href="https://console.aws.amazon.com/console/home">AWS console</a>.</p>
        
        <p>Configuration file sample</p>
        
        <code><pre>[s3]
default=account1
account1.access_key = AKIAZIOJDIOHUHEUINDLOI
account1.secret_key = Azioujeiojpdo1233/haiuzeyiuhoiasjo3QS
account2.access_key = AKIAPOVCXVKNZEHIOJIOJF
account2.secret_key = B123qsdiojpazeokpz235/ZHjqbuohzaiojz2</pre></code>

        <h2>URLs</h2>

        <p>URLs are in the form <code>s3://PATH</code>, with the following examples:</p>

        <ul>
          <li><code>s3://my-bucket/path/within/bucket</code></li>
          <li><code>s3://a/path/somewhere</code> (the default_path will be prepended)
        </ul>
        
        <p>Non-default accounts are accessed using the <code>s3://account@bucket/path</code> syntax.</p>
        
         <p>For example, to copy a file from the default S3 account to a specific S3 account:</p>
        <code><pre>% dctc cp s3://bucket1/folder/path s3://account2@bucket2/other_folder/path</pre></code>


        <h1>Google Cloud Storage</h1>

        <h2>Configuration</h2>

        <p>For GCS, dctc provides an automatic wizard to help you configure your account. Run it with:</p>
        <pre><code>% dctc add-account gs [account_name]</code></pre>
        <p>If you want to add multiple GCS accounts, specifying an account name is mandatory.</p>

        An GS account can also be manually configured. The following parameters are recognized:
        <ul>
          <li><strong>mail</strong>: Service account email address (in the form number-string@developer.gserviceaccount.com)</li>
          <li><strong>key_path</strong>: Absolute path to the private key file that you downloaded from Google</li>
          <li><strong>default_path</strong>: A fragment that will be prepended to all non-absolute paths</li>
        </ul>

        <p>To create a service account, go to the "API Access" page of the <a href="https://code.google.com/apis/console">APIS console</a>, create an OAuth access if you have not yet done so, and then create a <em>Service Account</em>.
          Google will let you download a .p12 key file. Save it to disk and use the path to the saved key in the <code>key_path</code> parameter.
        </p>

        <p>Configuration file sample</p>
        
        <code><pre>[gs]
default=account1
account1.mail = 5456156165164554@developer.gserviceaccount.com
account1.key_path = /Users/john/secret/gs/key_5456156165164554.p12
account2.mail = 123095490690384@developer.gserviceaccount.com
account2.secret_key = /Users/john/secret/gs/key_123095490690384.p12</pre></code>

        <h2>URLs</h2>

        URLs are in the form <code>gs://PATH</code>, with the following examples:

        <ul>
          <li><code>gs://my-bucket/path/within/bucket</code></li>
          <li><code>gs://a/path/somewhere</code> (the default_path will be prepended)
        </ul>

        <p>Non-default accounts are accessed using the <code>gs://account@bucket/path</code> syntax.</p>
        
        <p>For example, to copy a file from the default GS account to a specific GS account:</p>
        <code><pre>% dctc cp gs://bucket1/folder/path gs://account2@bucket2/other_/path</pre></code>


        <h1>FTP</h1>

        <p><code>dctc</code> can operate on FTP filesystems:</p>
          
        <ul>
          <li>either using the configuration file, with an account specifying the hostname, username and password,</li>
          <li>or by specifying all required data in the URL</li>
        </ul>
          
        <h3>With configuration</h3>

        <p>Configuration for a FTP account must contain the following parameters:</p>
        <ul>
          <li><strong>host</strong>: FTP Server host name</li>
          <li><strong>username</strong>: User name</li>
          <li><strong>password</strong>: Password</li>
        </ul>

        <p>
          In the file URL, you then need to use the name of the account.
          For example: <code>ftp://accountname@/path/on/the/ftp/server</code>
        </p>

        <p><strong>Important note: </strong> FTP does not support the notion of "default" account.
        You must always explicitely indicate an account with <code>accountname@</code>.</p>

        <h3>Specifying data in the URL</h3>

        <p>You can specify on the URL a FTP connection, either with anonymous FTP connection or with a login:</p>
        <ul>
          <li><code>ftp://host/path</code></li>
          <li><code>ftp://username:password@host/path</code></li>
        </ul>

        <h3>Example</h3>
        
        <p>With the following configuration file:</p>
        <pre><code>[ftp]
company.hostname = ftp.mycompany.com
company.username = john
company.password = thisisaverysecretpasswordnobodywillguessit
        </code></pre>
        
        <p>you could have the following:</p>
        
        <pre><code>% dctc cp -R ftp://company@/secret_documents ftp://hacker:h4cK3RZP4ssword@ftp.hackers.com/path
# Get some documents out of the company FTP to ftp.hackers.com.
# Connection data to company FTP is from the configuration file.
# Connection data to hackers FTP is on the URL

% dctc sync ftp://ftp.free.fr/pub/Distributions_Linux/debian-cd/ ftp://company@/debian-mirror
# Synchronize incrementally all data from ftp.free.fr (which allows anonymous login) 
# to a path on the company FTP</code></pre>
        


        <h1>SCP / SFTP</h1>
        
        
        <p><code>dctc</code> can operate on SCP filesystems:</p>
          
        <ul>
          <li>either using the configuration file, with an account specifying the hostname, username and optionally password or private key file,</li>
          <li>or by specifying all required data in the URL</li>
        </ul>

        <h3>With configuration</h3>

        <p>Configuration for a SCP connection must contain the following parameters (the protocol name is "ssh"):</p>
        <ul>
          <li><strong>host</strong>: SSH Server host name</li>
          <li><strong>username</strong>: User name</li>
          <li>Optional : <strong>password</strong>: Password</li>
          <li>Optional : <strong>key</strong>: SSH private key file path</li>
          <li>Optional : <strong>passphrase</strong>: SSH private key passphrase</li>
          <li>Optional : <strong>skip_host_key_check</strong>: Allow connection without prompt, even if the host is not in the ~/.ssh/known_hosts file</li>
        </ul>

        <ul>
          <li> If neither password nor key are specified, password is prompted on the command line.</li>
          <li> If key is specified, but passphrase is not specified and the key is encrypted, passphrase is prompted on the command line.
         </li>
        </ul>

        <p>
          The URL to use is then <code>ssh://account_name@:/absolute/path</code> or 
          <code>ssh://account_name@:path/relative/to/homedir</code>.
          </p>
        <p>
          <strong>Important note: </strong> SSH does not support the "default" account. 
          You must always indicate an account with <code>accountname@</code>.
        </p>

        <h3>On the command line</h3>

        <p>You can specify on the URL a SSH remote, using:
           <code>ssh://user@host:/absolute/path</code> or 
           <code>ssh://user@host:path/relative/to/homedir</code>.<br />
           This only supports password authentication. The password is prompted on the command line.
        </p>
        
        <h3>Example</h3>

   <p>With the following configuration file:</p>
        <pre><code>[ssh]
server1.hostname = server1.mycompany.com
server1.username = john
server1.key = /home/john/.ssh/id_rsa

server2.hostname = server2.mycompany.com
server2.username = john

server3.hostname = server3.mycompany.com
server3.username = john
server3.password = myp4sswoRd</code></pre>
        
        <p>you could have the following:</p>
        
        <pre><code>% dctc cp -R ssh://server1@:folder ssh://server2@:/backup
# Backup data from $HOME/folder on server1 to /backup on server2.
# Password for server2 will be prompted on the command line.

% dctc ls ssh://john@server4.mycompany.com:
# List $HOME on server4. Password for server4 will be prompted on the command line</code></pre>

      </section>

      <footer>
        <p>This project is maintained by <a href="https://github.com/dataiku">dataiku</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>

    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
      var pageTracker = _gat._getTracker("UA-34872768-2");
      pageTracker._trackPageview();
    } catch(err) {}
    </script>

  </body>
  </html>
